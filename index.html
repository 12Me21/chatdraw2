<!doctype html><html lang=en-QS><meta charset=utf-8><meta name=viewport content="width=device-width, height=device-height, initial-scale=1" id=$meta_viewport>
<title>CHATDRAW 2!!!</title>
<link rel=icon sizes=16x16 href=favicon.gif>
<style>
	html, body {
		position: fixed;
		overflow: clip; overflow: hidden;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
	}
	/*body {
		display: flex;
		flex-flow: column;
	}
	chat-draw {
		align-self: center;
	}*/
</style>


<!-- preload to prevent flash of unstyled -->
<!--<link rel=preload href=style.css?2 as=style>
<link rel=preload href=deco.css?2 as=style>-->

<script src=brush.js?2></script>
<script src=interface.js?2></script>

<div>
	<label>Scale: <input type=number min=1 max=10 value=2 id=$scale size=3 onchange="chatdraw.set_scale(value/devicePixelRatio)"></label>
	<label>Load file: <input type=file onchange=load_image(files[0]) accept=image/png></label>
	<label style=color:goldenrod>Last stroke: <i id=$stroke></i></label>
</div>
<hr>
<chat-draw></chat-draw>
<hr>

<script>
	let IOS_SAFARI = CSS.supports('-webkit-touch-callout', 'none')
	// disable the automatic zoom when focusing text inputs in safari
	if (IOS_SAFARI)
		$meta_viewport.content += ", user-scalable=no"
	
	let $stroke = window.$stroke
	
	let chatdraw = document.querySelector('chat-draw')
	$scale.onchange()
	async function load_image(file) {
		let url = URL.createObjectURL(file)
		try {
			let img = new Image()
			img.src = url
			await img.decode()
			chatdraw.history.add()
			chatdraw.grp.put_image(img, new Point(0,0))
			chatdraw.grp.replace_color('#E4D8A9', null)
		} finally {
			URL.revokeObjectURL(url)
		}
	}
</script>

<hr>
testing:
<textarea id=$code></textarea>
<button onclick="$log.textContent='...';$log.textContent=eval($code.value)">run</button>
<pre id=$log></pre>
